---
title: "Assignment2"
author: "Vienna Saccomanno"
date: "2/10/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages}

library(tidyverse)
library(scales)

```

##Task 1. Cetaceans in Captivity

```{r get_data}
cetaceans<- read_csv("captive_cetacean.csv")
```

```{r}

cod<- cetaceans %>%
  filter(acquisition %in% c("Rescue", "Capture", "Born")) %>% 
  mutate(acquisition = recode_factor(acquisition,
   'Rescue' = 'Rescued', 'Born' = 'Born in Captivity', 'Capture' = 'Captured')
  ) 
 
cod$originDate = as.Date(as.character(cod$originDate), format = "%m/%d/%y", "%y")
View(cod)

cod_viz<- cod %>% 
  ggplot(aes(x=originDate, fill=as.factor(acquisition)))+
                   geom_histogram(alpha=0.7, bins = 90, color= "black", linetype = "solid") +
  scale_fill_manual(name= "Acquisition\nType", values = c("Captured" = "red",
                              "Born in Captivity"="yellow",
                              "Rescued" = "blue"))+
  scale_x_date(breaks = date_breaks("10 years"), 
               labels = date_format("%Y")) + 
  scale_y_discrete(limits=seq(0,170,20))+
  labs(x= '',
       y= 'Number of Cetaceans')+
  theme_classic()
 
cod_viz

```


##Task 2. Parameter Estimation - Wild Fish Catch
```{r get_data2}
#Read-in catch data
catch<- read_csv("fish_catch.csv")

```

```{r exploratory graph}

#Making an exploratory graph to estimate the structure of the data
ggplot(catch, aes(x=Year, y=Wild_Catch))+
  geom_point()
#Data look non-linear, and somewhat logistic
Bestimate<- (90 - 15)/15

#Slope of natural log (y=e^rt -> ln(y) = rt) = r
#Looking at the graph, time 0-4 was the exponential growth

```

Recall logistic growth equation: 

N(t) = A/(1+Be^-rt)
# Estimate for K/A: ~ 90
# Estimate for N0: ~ 15
# Estimate for B: ~ 5

BEstimate <- (3700 - 2000)/2000 # BEstimate = 0.85